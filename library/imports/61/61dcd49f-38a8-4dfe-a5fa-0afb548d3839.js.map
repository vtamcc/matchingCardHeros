{"version":3,"sources":["assets/MatchingCardHeros/scripts/game/popup/Shop/CardHero.ItemShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Global } from \"../../../CardHero.Global\";\nimport GameView from \"../../CardHero.GameView\";\nimport Level from \"../../CardHero.LevelView\";\nimport ShopView from \"./CardHero.ShopView\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class ItemShop extends cc.Component {\n\n    @property(cc.Node)\n    nItem: cc.Node = null;\n    @property(cc.Node)\n    nMask: cc.Node = null;\n    // @property(cc.Label)\n    // lbPrice: cc.Label = null;\n\n    idItem = 0;\n    price: number = 0;\n\n    onLoad() {}\n\n    setData(id, price) {\n        this.idItem = id;\n        this.price = price;  // Đặt giá của item tại đây\n        this.nItem.getComponent(cc.Sprite).spriteFrame = ShopView.instance.listSpfItem[id];\n        this.updatePrice();\n        this.checkBuy();\n    }\n\n    updatePrice() {\n        // Cập nhật giá của item\n        this.price = Global.priceItem[this.idItem];\n        console.log(`Price updated for item ${this.idItem}: ${this.price}`);\n    }\n\n    checkBuy() {\n        if (Global.totalGold >= this.price) {\n            this.nMask.active = false;\n            console.log(\"Tien\" , this.price);\n        } else {\n            this.nMask.active = true;\n        }\n    }\n\n    clickBuy() {\n        if (Global.totalGold >= this.price) {\n            if(this.idItem == 0) {\n                Global.totalGold -= Global.priceItem[this.idItem];\n                Global.priceItem[this.idItem]++;\n                ShopView.instance.updatePriceHp();\n                console.log(this.idItem);\n\n            }else if(this.idItem == 1) {\n                Global.totalGold -= Global.priceItem[this.idItem];\n                Global.priceItem[this.idItem]++;\n                ShopView.instance.updatePriceAttack();\n            }\n\n            console.log(\"Gold after purchase:\", Global.totalGold);\n            this.checkBuy();\n            this.saveItemState(); // Save item state after purchase\n            ShopView.instance.updateAllItems(); // Update all items\n            Level.instance.updateGold(); // Update the displayed gold amount\n            this.updatePrice(); // Cập nhật giá sau khi mua\n        } else {\n            console.log(\"Not enough gold!\");\n            this.nMask.active = true;\n        }\n       \n    }\n\n    saveItemState() {\n        const itemState = {\n            id: this.idItem,\n            price: this.price\n        };\n        cc.sys.localStorage.setItem(`item_${this.idItem}`, JSON.stringify(itemState));\n    }\n\n    start() {}\n\n    // update (dt) {}\n}"]}